import{Client as t}from"@stomp/stompjs";let e=null;const n=document.getElementById("currentEvent").dataset.environment.toLowerCase(),o=document.getElementById("currentEvent").dataset.port;export function startMetricsSocket(){if(e?.active)return;e=new t({brokerURL:"production"==n?"wss://pogotracker.app/ws":`ws://127.0.0.1:${o}/ws`,reconnectDelay:5e3,heartbeatIncoming:1e4,heartbeatOutgoing:1e4,connectHeaders:{},onConnect:()=>{e.subscribe("metrics",t=>{try{const e=JSON.parse(t.body);if(!e?.success)return;const n=new CustomEvent("metricsUpdate",{detail:e.data});document.dispatchEvent(n)}catch(t){}})},onStompError:t=>{}}),e.activate()}export function stopMetricsSocket(){e&&(e.deactivate(),e=null)}